<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Embedded Co-Design (VHDL and C): /home/student/netlabhome/Altera_Systems_Labs/New_FreeRTOS/FreeRTOS/Demo/NiosII_CycloneIII_DBC3C40_GCC/RTOSDemo/Arms_Race/keypad.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>      </li>
      <li><a class="el" href="dir_838608702a48ab2d6d07b5477858f42f.html">student</a>      </li>
      <li><a class="el" href="dir_dba29d339fe0f0e9eee2d0d877a9f2a7.html">netlabhome</a>      </li>
      <li><a class="el" href="dir_a1039001424a9b65c15134c0a4418042.html">Altera_Systems_Labs</a>      </li>
      <li><a class="el" href="dir_cf3df47d55074d431f85fc2cd798e2fb.html">New_FreeRTOS</a>      </li>
      <li><a class="el" href="dir_1a0c7a950cc55f3c0c8cecb3833d96b2.html">FreeRTOS</a>      </li>
      <li><a class="el" href="dir_c5e400573fa88499f74521c358c36f55.html">Demo</a>      </li>
      <li><a class="el" href="dir_702e5a272eb1478983a0f996116659b7.html">NiosII_CycloneIII_DBC3C40_GCC</a>      </li>
      <li><a class="el" href="dir_c4f2b08ffc1861ab78e1f05032156428.html">RTOSDemo</a>      </li>
      <li><a class="el" href="dir_9f9bad4889f4532e9a758f5a7fbfcd31.html">Arms_Race</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>keypad.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="_free_r_t_o_s_8h_source.html">FreeRTOS.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="task_8h_source.html">task.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="queue_8h_source.html">queue.h</a>&quot;</code><br/>
<code>#include &quot;altera_avalon_pio_regs.h&quot;</code><br/>
<code>#include &quot;alt_types.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="keypad_8h_source.html">keypad.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for keypad.c:</div>
<div class="dyncontent">
<div class="center"><img src="keypad_8c__incl.png" border="0" usemap="#_2home_2student_2netlabhome_2_altera___systems___labs_2_new___free_r_t_o_s_2_free_r_t_o_s_2_demo_2_nios_i_i___cyclone_i_i_i___d_b_c3_c40___g_c_c_2_r_t_o_s_demo_2_arms___race_2keypad_8c" alt=""/></div>
<map name="_2home_2student_2netlabhome_2_altera___systems___labs_2_new___free_r_t_o_s_2_free_r_t_o_s_2_demo_2_nios_i_i___cyclone_i_i_i___d_b_c3_c40___g_c_c_2_r_t_o_s_demo_2_arms___race_2keypad_8c" id="_2home_2student_2netlabhome_2_altera___systems___labs_2_new___free_r_t_o_s_2_free_r_t_o_s_2_demo_2_nios_i_i___cyclone_i_i_i___d_b_c3_c40___g_c_c_2_r_t_o_s_demo_2_arms___race_2keypad_8c">
<area shape="rect" id="node11" href="_free_r_t_o_s_8h.html" title="FreeRTOS.h" alt="" coords="389,83,483,112"/><area shape="rect" id="node28" href="task_8h.html" title="task.h" alt="" coords="507,83,568,112"/><area shape="rect" id="node33" href="queue_8h.html" title="queue.h" alt="" coords="632,160,707,189"/><area shape="rect" id="node40" href="keypad_8h.html" title="keypad.h" alt="" coords="963,83,1043,112"/><area shape="rect" id="node14" href="projdefs_8h.html" title="projdefs.h" alt="" coords="181,160,267,189"/><area shape="rect" id="node16" href="_free_r_t_o_s_config_8h.html" title="FreeRTOSConfig.h" alt="" coords="291,160,424,189"/><area shape="rect" id="node20" href="portable_8h.html" title="portable.h" alt="" coords="448,160,533,189"/><area shape="rect" id="node22" href="portmacro_8h.html" title="portmacro.h" alt="" coords="440,237,541,267"/><area shape="rect" id="node26" href="mpu__wrappers_8h.html" title="mpu_wrappers.h" alt="" coords="585,237,713,267"/><area shape="rect" id="node31" href="list_8h.html" title="list.h" alt="" coords="557,160,608,189"/></map>
</div>

<p><a href="keypad_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypad_8c.html#a4679d8ea8690999a6c6c7c0cb245c879">THRESHOLD</a>&nbsp;&nbsp;&nbsp;20</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypad_8c.html#a2149951cfe6d8cbd12f4dd246e5c7afd">sd_card_read_names</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypad_8c.html#a34b7ad8e2dbafd03c877d98a66654527">sd_card_read_file</a> (char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypad_8c.html#a97910a3fb8d8af32f7bf1d113178301f">vTaskKeyPad</a> (void *pvParameters)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Key Pad Task.  <a href="#a97910a3fb8d8af32f7bf1d113178301f"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="keypad_8c.html#a3d6f6ccdd61cdf1820127991c9c23f07">key_assignment</a> []</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a4679d8ea8690999a6c6c7c0cb245c879"></a><!-- doxytag: member="keypad.c::THRESHOLD" ref="a4679d8ea8690999a6c6c7c0cb245c879" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THRESHOLD&nbsp;&nbsp;&nbsp;20</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="keypad_8c_source.html#l00026">26</a> of file <a class="el" href="keypad_8c_source.html">keypad.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a34b7ad8e2dbafd03c877d98a66654527"></a><!-- doxytag: member="keypad.c::sd_card_read_file" ref="a34b7ad8e2dbafd03c877d98a66654527" args="(char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sd_card_read_file </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2149951cfe6d8cbd12f4dd246e5c7afd"></a><!-- doxytag: member="keypad.c::sd_card_read_names" ref="a2149951cfe6d8cbd12f4dd246e5c7afd" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sd_card_read_names </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a97910a3fb8d8af32f7bf1d113178301f"></a><!-- doxytag: member="keypad.c::vTaskKeyPad" ref="a97910a3fb8d8af32f7bf1d113178301f" args="(void *pvParameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vTaskKeyPad </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pvParameters</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Key Pad Task. </p>
<p>This function continuously polls the hardware registered checking for a valid keypress. The No Key Pressed bit is bit 5, which this bit is set to 0, a key has been pressed and the lower 4 bits will represent the value of the button pressed.</p>
<p>There is a bug, sometimes the value of the NKP bit is set just before or after the register is read, the workaround is to first read the value, and if its the first time the button's been pressed, read again after a delay to double check the value is valid.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pvParameters</em>&nbsp;</td><td>Standard FreeRTOS parameters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Void. </dd></dl>

<p>Definition at line <a class="el" href="keypad_8c_source.html#l00054">54</a> of file <a class="el" href="keypad_8c_source.html">keypad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_cgraph.png" border="0" usemap="#keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_cgraph" alt=""/></div>
<map name="keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_cgraph" id="keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_cgraph">
<area shape="rect" id="node3" href="task_8h.html#a3fc5adc340b17cb07c12ffa90d7bb8f3" title="vTaskDelay" alt="" coords="156,5,247,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_icgraph.png" border="0" usemap="#keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_icgraph" alt=""/></div>
<map name="keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_icgraph" id="keypad_8c_a97910a3fb8d8af32f7bf1d113178301f_icgraph">
<area shape="rect" id="node3" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="Main." alt="" coords="156,5,209,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a3d6f6ccdd61cdf1820127991c9c23f07"></a><!-- doxytag: member="keypad.c::key_assignment" ref="a3d6f6ccdd61cdf1820127991c9c23f07" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="keypad_8h.html#a3d6f6ccdd61cdf1820127991c9c23f07">key_assignment</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
  <span class="stringliteral">&quot;RESET&quot;</span>,  <span class="stringliteral">&quot;XUP&quot;</span>, <span class="stringliteral">&quot;BLANK1&quot;</span>, <span class="stringliteral">&quot;PLAY&quot;</span>,
  <span class="stringliteral">&quot;XLEFT&quot;</span>,   <span class="stringliteral">&quot;UP&quot;</span>, <span class="stringliteral">&quot;XRIGHT&quot;</span>, <span class="stringliteral">&quot;PAUSE&quot;</span>,
  <span class="stringliteral">&quot;LEFT&quot;</span>,  <span class="stringliteral">&quot;DOWN&quot;</span>,  <span class="stringliteral">&quot;RIGHT&quot;</span>, <span class="stringliteral">&quot;BLANK2&quot;</span>,
  <span class="stringliteral">&quot;STOP&quot;</span>, <span class="stringliteral">&quot;XDOWN&quot;</span>, <span class="stringliteral">&quot;CANCEL&quot;</span>, <span class="stringliteral">&quot;ENTER&quot;</span>
}
</pre></div>
<p>Definition at line <a class="el" href="keypad_8c_source.html#l00031">31</a> of file <a class="el" href="keypad_8c_source.html">keypad.c</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Mar 27 2012 15:09:47 for Embedded Co-Design (VHDL and C) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
